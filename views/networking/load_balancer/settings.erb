<% edit_perm = has_permission?("LoadBalancer:edit", @lb)
delete_perm = has_permission?("LoadBalancer:delete", @lb) %>

<% if edit_perm || delete_perm %>
  <div class="p-6">
    <div class="flex-header">
      <div class="flex-title">
        <h3 class="section-heading">
          Danger Zone
        </h3>
      </div>
    </div>
    <div class="table-card">
      <% if edit_perm %>
        <div class="card-body">
          <% form(action: "#{path(@lb)}/rename", method: :post) do %>
            <%== part("components/rename_object_input", object: @lb, type: "load balancer", text: "Renaming a load balancer changes the DNS name used, so configuration changes may be required if the load balancer is renamed. You will also need to renew the SSL certificate in the virtual machines attached to this load balancer.") %>
          <% end %>
        </div>
        <div class="card-body">
          <div class="flex-header-sm">
            <div>
              <h3 class="subsection-heading">SSL Certificate</h3>
              <div class="description-text">
                <p>Ubicloud automatically provides a free SSL certificate for your load balancer. To enable it, toggle
                  the switch.</p>
                <p>Learn more about Ubicloud SSL certificates in the
                  <a
                    href="https://www.ubicloud.com/docs/networking/load-balancer#ssl-certificates"
                    class="link-primary"
                    target="_blank"
                  >documentation</a>.</p>
              </div>
            </div>
            <div class="actions-right">
              <%== part("components/form/toggle_form", name: "cert_enabled", action: "#{path(@lb)}/toggle-ssl-certificate", active: @lb.cert_enabled) %>
            </div>
          </div>
        </div>
      <% end %>
      <% if delete_perm %>
        <div class="card-body">
          <div class="flex-header-sm">
            <div>
              <h3 class="subsection-heading">Delete load balancer</h3>
              <div class="description-text">
                <p>This action will permanently delete this load balancer. Deleted load balancer cannot be recovered.
                  Use it carefully.</p>
              </div>
            </div>
            <div class="actions-right">
              <%== part("components/delete_button", url: path(@lb), confirmation: @lb.name, redirect: "#{@project.path}/load-balancer") %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
<% end %>
